<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>The Wind | Guild system</title>
  <link rel="stylesheet" href="styles.css?v=bgfit3" />
  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
</head>
<body>
  <!-- 헤더 -->
  <header class="page-header">
    <div class="brand">
      <img class="mascot" src="assets/윈둥이.png" alt="logo" />
      <div class="titles">
        <h1>The Wind</h1>
        <p>길드관리 시스템에 오신걸 환영합니다.</p>
      </div>
    </div>

    <div class="auth">
      <!-- 비로그인 -->
      <div id="authSignedOut" class="auth-inline">
        <input id="email" type="email" placeholder="이메일" />
        <input id="password" type="password" placeholder="비밀번호" />
        <button id="loginBtn" class="btn">로그인</button>
        <button id="firstJoinBtn" class="btn ghost">최초가입</button>
        <button id="kakaoBtn" class="btn kakao">카카오 로그인 (준비중)</button>
      </div>

      <!-- 로그인 -->
      <div id="authSignedIn" class="auth-inline" style="display:none">
        <span id="whoami" class="pill">-</span>
        <a id="adminLink" href="admin.html" class="btn ghost" style="display:none">관리자 메뉴</a>
        <button id="logoutBtn" class="btn danger">로그아웃</button>
      </div>
    </div>
  </header>

  <!-- 본문 -->
  <main class="stage">
    <section class="parchment">
      <div class="parchment-inset">
        <!-- 좌측: 내 전투력 -->
        <div class="card left">
          <h2>내 전투력</h2>

          <!-- 로그인 전: 영상 -->
          <div id="guestPanel" class="guest-video">
            <video src="assets/wind_strike.mp4" autoplay muted loop playsinline></video>
          </div>

          <!-- 로그인 후: 입력 -->
          <div id="mePanel" class="me-panel" style="display:none">
            <div class="my-quick">
              <div class="stat"><span class="label">순위</span><span id="rank" class="value">-</span></div>
              <div class="stat"><span class="label">레벨</span><span id="levelLabel" class="value">-</span></div>
              <div class="stat"><span class="label">전투력</span><span id="bpLabel" class="value">-</span></div>
            </div>
            <div class="small dim">
              <b>스탯 업데이트</b> 저장 버튼을 누르기 전까지는 반영되지 않습니다.
            </div>

            <div class="grid stats-grid">
              <label>레벨 <input id="level" type="number" min="0" /></label>
              <label>공격 <input id="attack" type="number" min="0" /></label>
              <label>방어 <input id="defence" type="number" min="0" /></label>
              <label>명중 <input id="accuracy" type="number" min="0" /></label>
              <label>기억% <input id="memory_pct" type="number" step="0.01" min="0" max="100" /></label>
              <label>토벌 <input id="subjugate" type="number" min="0" /></label>
            </div>

            <div id="attendLine" class="attendance"></div>

            <div class="actions">
              <button id="saveStats" class="btn primary">저장</button>
              <span id="saveResult" class="small"></span>
            </div>
          </div>
        </div>

        <!-- 우측: 명예의 전당 -->
        <div class="card right">
          <div class="hall-head">
            <h2>명예의 전당</h2>
            <div class="tabs">
              <button id="tabScore" class="chip on">전투력부문</button>
              <button id="tabTotal" class="chip">종점부문</button>
            </div>
          </div>

          <!-- HTML 기본 플레이스홀더 (JS 실패해도 비지 않게) -->
          <div id="hof" class="hof">
            <div class="hof-card first"><img src="assets/윈둥자.png" alt=""><div class="name">-</div></div>
            <div class="hof-card second"><img src="assets/윈둥자.png" alt=""><div class="name">-</div></div>
            <div class="hof-card third"><img src="assets/윈둥자.png" alt=""><div class="name">-</div></div>
            <div class="hof-card fourth"><img src="assets/윈둥자.png" alt=""><div class="name">-</div></div>
            <div class="hof-card fifth"><img src="assets/윈둥자.png" alt=""><div class="name">-</div></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- 최초가입 모달 -->
  <dialog id="firstJoinModal" class="modal">
    <div class="modal-card">
      <h3>최초가입</h3>

      <label>이메일
        <input id="firstJoinEmail" type="email"
               placeholder="스탠더님이 우편을 받으실 메일 주소를 알려주세요." required />
      </label>

      <label>비밀번호
        <input id="firstJoinPassword" type="password"
               placeholder="아무도 모를만한 비밀번호를 입력해주세요." required />
      </label>

      <label>비밀번호 확인
        <input id="firstJoinPassword2" type="password"
               placeholder="비밀번호를 다시 확인해주세요." required />
      </label>

      <label>게임 내 닉네임
        <input id="firstJoinNickname" type="text" placeholder="스탠더님의 닉네임을 알려주세요" required />
      </label>

      <label>내 클래스는…
        <select id="firstJoinClass" required>
          <option value="">클래스를 선택해주시기 바랍니다.</option>
        </select>
      </label>

      <div id="firstJoinMsg" class="small"></div>
      <div class="modal-actions">
        <button id="firstJoinSubmit" class="btn primary">가입 요청</button>
        <button id="firstJoinClose" class="btn ghost">닫기</button>
      </div>
    </div>
  </dialog>

  <!-- Supabase 환경값 -->
  <script>
    window.__SB_URL__  = "https://zxmihqapcemjmzoagpjm.supabase.co";
    window.__SB_ANON__ = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp4bWlocWFwY2Vtam16b2FncGptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxOTE5MDEsImV4cCI6MjA3MTc2NzkwMX0.byvaKSk5JovNr5WmXFXCp9LKqAhEDub642thN5j9fwA";
  </script>
  <script src="app.js?v=hoffix3"></script>
</body>
</html>
