<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>The Wind | Guild System</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
</head>
<body>
  <!-- 헤더 -->
  <header class="page-header">
    <div class="brand">
      <img class="mascot" src="assets/윈둥이.png" alt="logo" />
      <div class="titles">
        <h1>The Wind</h1>
        <p>길드관리 시스템에 오신걸 환영합니다.</p>
      </div>
    </div>

    <div class="auth">
      <!-- 비로그인 -->
      <div id="authSignedOut" class="auth-inline">
        <input id="email" type="email" placeholder="이메일" />
        <input id="password" type="password" placeholder="비밀번호" />
        <button id="loginBtn" class="btn">로그인</button>
        <button id="firstJoinBtn" class="btn ghost">최초가입</button>
      </div>

      <!-- 로그인 -->
      <div id="authSignedIn" class="auth-inline" style="display:none">
        <span id="whoami" class="pill">-</span>
        <a id="adminLink" href="admin.html" class="btn ghost" style="display:none">관리자 메뉴</a>
        <button id="logoutBtn" class="btn danger">로그아웃</button>
      </div>
    </div>
  </header>

  <!-- 본문 -->
  <main class="stage">
    <section class="parchment">
      <img class="parchment-bg" src="assets/bg.png" alt="" />
      <div class="parchment-inset">
        <!-- 좌측: 내 전투력 -->
        <div class="card left">
          <h2>내 전투력</h2>

          <!-- 로그인 전: 영상 -->
          <div id="guestPanel" class="guest-video">
            <video src="assets/wind_strike.mp4" autoplay muted loop playsinline></video>
          </div>

          <!-- 로그인 후: 입력 -->
          <div id="mePanel" class="me-panel" style="display:none">
            <div class="my-quick">
              <div class="stat"><span class="label">순위</span><span id="rank" class="value">-</span></div>
              <div class="stat"><span class="label">레벨</span><span id="levelLabel" class="value">-</span></div>
              <div class="stat"><span class="label">전투력</span><span id="bpLabel" class="value">-</span></div>
            </div>
            <div class="small dim">
              <b>스탯 업데이트</b> 저장 버튼을 누르기 전까지는 반영되지 않습니다.
            </div>

            <div class="grid stats-grid">
              <label>레벨
                <input id="level" type="number" min="0" />
              </label>
              <label>공격
                <input id="attack" type="number" min="0" />
              </label>
              <label>방어
                <input id="defence" type="number" min="0" />
              </label>
              <label>명중
                <input id="accuracy" type="number" min="0" />
              </label>
              <label>기억%
                <input id="memory_pct" type="number" step="0.01" min="0" max="100" />
              </label>
              <label>토벌
                <input id="subjugate" type="number" min="0" />
              </label>
            </div>

            <div id="attendLine" class="attendance"></div>

            <div class="actions">
              <button id="saveStats" class="btn primary">저장</button>
              <span id="saveResult" class="small"></span>
            </div>
          </div>
        </div>

        <!-- 우측: 명예의 전당 -->
        <div class="card right">
          <div class="hall-head">
            <h2>명예의 전당</h2>
            <div class="tabs">
              <button id="tabScore" class="chip on">전투력부문</button>
              <button id="tabTotal" class="chip">종점부문</button>
            </div>
          </div>

          <!-- 왼쪽 1st + 오른쪽 2x2 -->
          <div id="hof" class="hof"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- 최초가입 모달 -->
  <dialog id="firstJoinModal" class="modal">
    <div class="modal-card">
      <h3>최초가입</h3>

      <label>이메일
        <input id="firstJoinEmail" type="email" placeholder="you@example.com" required />
      </label>

      <label>비밀번호
        <input id="firstJoinPassword" type="password" placeholder="8자 이상" required />
      </label>

      <label>비밀번호 확인
        <input id="firstJoinPassword2" type="password" placeholder="다시 입력" required />
      </label>

      <label>스탠더님의 닉네임을 알려주세요
        <input id="firstJoinNickname" type="text" placeholder="게임 내 닉네임" required />
      </label>

      <label>내 클래스는…
        <select id="firstJoinClass" required>
          <option value="">클래스 선택</option>
        </select>
      </label>

      <div id="firstJoinMsg" class="small"></div>
      <div class="modal-actions">
        <button id="firstJoinSubmit" class="btn primary">가입 요청</button>
        <button id="firstJoinClose" class="btn ghost">닫기</button>
      </div>
    </div>
  </dialog>

  <!-- Supabase 환경값: 프로젝트 키로 교체 -->
  <script>
    window.__SB_URL__  = "https://YOUR-PROJECT.supabase.co";
    window.__SB_ANON__ = "YOUR-ANON-KEY";
  </script>
  <script src="app.js"></script>
</body>
</html>
